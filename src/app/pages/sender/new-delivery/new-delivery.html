<div class="relative w-full h-[calc(100vh-80px)] bg-uni-950 overflow-hidden flex flex-col md:flex-row">
  
  <!-- ===========================
       LEFT PANEL: BOOKING FORM
       =========================== -->
  <div #bookingPanel class="w-full md:w-[480px] h-full bg-gray-900/95 backdrop-blur-xl border-r border-white/5 relative z-20 shadow-[20px_0_50px_rgba(0,0,0,0.5)] flex flex-col opacity-0 -translate-x-10">
    
    <!-- Header -->
    <div class="p-6 border-b border-white/5">
      <h2 class="text-xl font-black text-white tracking-tight flex items-center gap-2">
        <lucide-icon [img]="MapPin" class="text-uni-500"></lucide-icon> New Delivery
      </h2>
    </div>

    <!-- Scrollable Form -->
    <div class="flex-1 overflow-y-auto p-6 space-y-8">
      
      <!-- 1. ROUTE SECTION -->
      <div class="relative">
        <!-- Connecting Line -->
        <div class="absolute left-[19px] top-10 bottom-10 w-0.5 border-l-2 border-dashed border-gray-700"></div>

        <!-- Pickup -->
        <div class="mb-4 relative group">
          <label class="text-[10px] font-bold text-uni-500 uppercase tracking-widest mb-1.5 block ml-10">Pickup</label>
          <div class="flex items-center gap-4">
             <div class="w-10 h-10 rounded-full bg-uni-500/10 border border-uni-500/30 flex items-center justify-center shrink-0 text-uni-500 shadow-[0_0_15px_rgba(101,214,84,0.1)] z-10">
               <div class="w-2.5 h-2.5 bg-uni-500 rounded-full"></div>
             </div>
             <input 
                type="text" 
                [(ngModel)]="pickupLocation"
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:outline-none focus:border-uni-500 focus:ring-1 focus:ring-uni-500 transition-all font-medium"
                placeholder="Ex: Marjane Market..."
             >
          </div>
        </div>

        <!-- Dropoff -->
        <div class="relative group">
          <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1.5 block ml-10">Dropoff</label>
          <div class="flex items-center gap-4">
             <div class="w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center shrink-0 text-gray-400 z-10">
               <div class="w-2.5 h-2.5 bg-white rounded-sm transform rotate-45"></div>
             </div>
             <input 
                type="text" 
                [(ngModel)]="dropoffLocation"
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:outline-none focus:border-uni-500 focus:ring-1 focus:ring-uni-500 transition-all font-medium"
                placeholder="Ex: Residence Al Yassamine..."
             >
          </div>
        </div>
      </div>

      <!-- 2. VEHICLE SELECTION -->
      <div>
        <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-3 block">Select Vehicle</label>
        <div class="grid grid-cols-3 gap-2">
          
          <!-- Moto -->
          <button (click)="selectedVehicle = 'MOTO'" 
             class="relative p-3 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 group"
             [ngClass]="selectedVehicle === 'MOTO' ? 'bg-uni-500/10 border-uni-500 text-uni-500' : 'bg-white/5 border-transparent text-gray-500 hover:bg-white/10'">
             <lucide-icon [img]="Bike" [size]="24"></lucide-icon>
             <span class="text-[10px] font-bold">Moto</span>
          </button>

          <!-- Car -->
          <button (click)="selectedVehicle = 'CAR'" 
             class="relative p-3 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 group"
             [ngClass]="selectedVehicle === 'CAR' ? 'bg-uni-500/10 border-uni-500 text-uni-500' : 'bg-white/5 border-transparent text-gray-500 hover:bg-white/10'">
             <lucide-icon [img]="Car" [size]="24"></lucide-icon>
             <span class="text-[10px] font-bold">Car</span>
          </button>

          <!-- Truck -->
          <button (click)="selectedVehicle = 'TRUCK'" 
             class="relative p-3 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 group"
             [ngClass]="selectedVehicle === 'TRUCK' ? 'bg-uni-500/10 border-uni-500 text-uni-500' : 'bg-white/5 border-transparent text-gray-500 hover:bg-white/10'">
             <lucide-icon [img]="Truck" [size]="24"></lucide-icon>
             <span class="text-[10px] font-bold">Truck</span>
          </button>
        </div>
      </div>

      <!-- 3. PRICE OFFER -->
      <div class="bg-gray-800/50 rounded-2xl p-4 border border-white/5">
        <div class="flex justify-between items-center mb-4">
           <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Offer Your Price</label>
           <lucide-icon [img]="Wallet" [size]="16" class="text-uni-500"></lucide-icon>
        </div>
        
        <div class="relative mb-4">
           <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-sm">MAD</span>
           <input 
              type="number" 
              [(ngModel)]="offerPrice"
              class="w-full bg-gray-900 border border-white/10 rounded-xl py-3 pl-14 pr-4 text-2xl font-black text-white focus:outline-none focus:border-uni-500 transition-colors placeholder-gray-700"
              placeholder="0.00"
           >
        </div>

        <!-- Quick Select Chips -->
        <div class="flex gap-2 overflow-x-auto pb-1 scrollbar-hide">
           <button *ngFor="let price of suggestedPrices" (click)="setPrice(price)" 
             class="px-3 py-1.5 rounded-lg border border-white/10 bg-white/5 text-xs font-bold text-gray-400 hover:bg-uni-500 hover:text-uni-950 hover:border-uni-500 transition-all whitespace-nowrap">
             {{price}} DH
           </button>
        </div>
      </div>

    </div>

    <!-- Footer Action -->
    <div class="p-6 border-t border-white/10 bg-gray-900 z-10">
      <button 
        (click)="findDriver()"
        [disabled]="!pickupLocation || !dropoffLocation || !offerPrice || isSearching"
        class="w-full py-4 bg-uni-500 text-uni-950 font-black rounded-xl shadow-[0_0_30px_rgba(101,214,84,0.3)] hover:shadow-[0_0_50px_rgba(101,214,84,0.5)] hover:bg-uni-400 transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-2 relative overflow-hidden group"
      >
        <!-- Loading State -->
        <span *ngIf="isSearching" class="flex items-center gap-2">
           <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
           Searching Drivers...
        </span>
        <!-- Normal State -->
        <span *ngIf="!isSearching" class="flex items-center gap-2">
           Find a Driver <lucide-icon [img]="Search" [size]="20" class="group-hover:scale-110 transition-transform"></lucide-icon>
        </span>
      </button>
    </div>

  </div>

  <!-- ===========================
       RIGHT PANEL: MAP AREA
       =========================== -->
  <div class="flex-1 relative bg-gray-800 overflow-hidden group/map">
    
    <!-- Placeholder Map (If no real map loaded) -->
    <div class="absolute inset-0 bg-[#1a1d21] flex items-center justify-center">
       <!-- Grid Pattern -->
       <div class="absolute inset-0 bg-[linear-gradient(to_right,#80808008_1px,transparent_1px),linear-gradient(to_bottom,#80808008_1px,transparent_1px)] bg-size-[40px_40px]"></div>
       
       <!-- Radar Animation (Visual Interest) -->
       <div class="relative flex items-center justify-center">
         <div class="absolute w-[500px] h-[500px] border border-uni-500/10 rounded-full animate-[spin_10s_linear_infinite]"></div>
         <div class="absolute w-[300px] h-[300px] border border-uni-500/20 rounded-full"></div>
         <div class="w-32 h-32 bg-gray-900 rounded-full flex items-col justify-center items-center border border-white/10 shadow-2xl z-10">
            <lucide-icon [img]="Map" class="text-gray-600 opacity-50" [size]="48"></lucide-icon>
         </div>
         <div class="absolute -bottom-12 text-gray-500 text-sm font-bold tracking-widest uppercase opacity-50">Map View Area</div>
       </div>
    </div>

    <!-- Floating Map Controls -->
    <div class="absolute bottom-8 right-8 flex flex-col gap-2 z-10 opacity-0 group-hover/map:opacity-100 transition-opacity duration-500 translate-y-4 group-hover/map:translate-y-0">
       <button class="w-10 h-10 bg-gray-900 text-white rounded-lg flex items-center justify-center border border-white/10 hover:bg-gray-800 shadow-xl">
         <lucide-icon [img]="Navigation" [size]="18"></lucide-icon>
       </button>
       <button class="w-10 h-10 bg-gray-900 text-white rounded-lg flex items-center justify-center border border-white/10 hover:bg-gray-800 shadow-xl">
         <span class="font-bold text-lg">+</span>
       </button>
       <button class="w-10 h-10 bg-gray-900 text-white rounded-lg flex items-center justify-center border border-white/10 hover:bg-gray-800 shadow-xl">
         <span class="font-bold text-lg">-</span>
       </button>
    </div>

  </div>

</div>
